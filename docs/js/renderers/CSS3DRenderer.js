(function(){const e=new THREE.Vector3,t=new THREE.Quaternion,n=new THREE.Vector3;class r extends THREE.Object3D{constructor(e=document.createElement("div")){super(),this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}r.prototype.isCSS3DObject=!0;class s extends r{constructor(e){super(e),this.rotation2D=0}copy(e,t){return super.copy(e,t),this.rotation2D=e.rotation2D,this}}s.prototype.isCSS3DSprite=!0;const o=new THREE.Matrix4,i=new THREE.Matrix4;class l{constructor(r={}){const s=this;let l,a,c,m;const p={camera:{fov:0,style:""},objects:new WeakMap},d=void 0!==r.element?r.element:document.createElement("div");d.style.overflow="hidden",this.domElement=d;const h=document.createElement("div");function u(e){return Math.abs(e)<1e-10?0:e}function y(e){const t=e.elements;return"matrix3d("+u(t[0])+","+u(-t[1])+","+u(t[2])+","+u(t[3])+","+u(t[4])+","+u(-t[5])+","+u(t[6])+","+u(t[7])+","+u(t[8])+","+u(-t[9])+","+u(t[10])+","+u(t[11])+","+u(t[12])+","+u(-t[13])+","+u(t[14])+","+u(t[15])+")"}function E(e){const t=e.elements,n="matrix3d("+u(t[0])+","+u(t[1])+","+u(t[2])+","+u(t[3])+","+u(-t[4])+","+u(-t[5])+","+u(-t[6])+","+u(-t[7])+","+u(t[8])+","+u(t[9])+","+u(t[10])+","+u(t[11])+","+u(t[12])+","+u(t[13])+","+u(t[14])+","+u(t[15])+")";return"translate(-50%,-50%)"+n}function f(r,l,a,c){if(r.isCSS3DObject){let c;r.onBeforeRender(s,l,a),r.isCSS3DSprite?(o.copy(a.matrixWorldInverse),o.transpose(),0!==r.rotation2D&&o.multiply(i.makeRotationZ(r.rotation2D)),r.matrixWorld.decompose(e,t,n),o.setPosition(e),o.scale(n),o.elements[3]=0,o.elements[7]=0,o.elements[11]=0,o.elements[15]=1,c=E(o)):c=E(r.matrixWorld);const m=r.element,d=p.objects.get(r);if(void 0===d||d.style!==c){m.style.transform=c;const e={style:c};p.objects.set(r,e)}m.style.display=r.visible?"":"none",m.parentNode!==h&&h.appendChild(m),r.onAfterRender(s,l,a)}for(let e=0,t=r.children.length;e<t;e++)f(r.children[e],l,a,c)}h.style.transformStyle="preserve-3d",h.style.pointerEvents="none",d.appendChild(h),this.getSize=function(){return{width:l,height:a}},this.render=function(e,t){const n=t.projectionMatrix.elements[5]*m;let r,s;p.camera.fov!==n&&(d.style.perspective=t.isPerspectiveCamera?n+"px":"",p.camera.fov=n),!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),t.isOrthographicCamera&&(r=-(t.right+t.left)/2,s=(t.top+t.bottom)/2);const o=t.isOrthographicCamera?"scale("+n+")translate("+u(r)+"px,"+u(s)+"px)"+y(t.matrixWorldInverse):"translateZ("+n+"px)"+y(t.matrixWorldInverse),i=o+"translate("+c+"px,"+m+"px)";p.camera.style!==i&&(h.style.transform=i,p.camera.style=i),f(e,e,t,o)},this.setSize=function(e,t){l=e,a=t,c=l/2,m=a/2,d.style.width=e+"px",d.style.height=t+"px",h.style.width=e+"px",h.style.height=t+"px"}}}THREE.CSS3DObject=r,THREE.CSS3DRenderer=l,THREE.CSS3DSprite=s})();