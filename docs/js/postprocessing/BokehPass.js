(function(){class e extends THREE.Pass{constructor(e,r,a){super(),this.scene=e,this.camera=r;const t=void 0!==a.focus?a.focus:1,s=void 0!==a.aspect?a.aspect:r.aspect,i=void 0!==a.aperture?a.aperture:.025,l=void 0!==a.maxblur?a.maxblur:1,h=a.width||window.innerWidth||1,n=a.height||window.innerHeight||1;this.renderTargetDepth=new THREE.WebGLRenderTarget(h,n,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter}),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new THREE.MeshDepthMaterial,this.materialDepth.depthPacking=THREE.RGBADepthPacking,this.materialDepth.blending=THREE.NoBlending,void 0===THREE.BokehShader&&console.error("THREE.BokehPass relies on THREE.BokehShader");const o=THREE.BokehShader,d=THREE.UniformsUtils.clone(o.uniforms);d["tDepth"].value=this.renderTargetDepth.texture,d["focus"].value=t,d["aspect"].value=s,d["aperture"].value=i,d["maxblur"].value=l,d["nearClip"].value=r.near,d["farClip"].value=r.far,this.materialBokeh=new THREE.ShaderMaterial({defines:Object.assign({},o.defines),uniforms:d,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader}),this.uniforms=d,this.needsSwap=!1,this.fsQuad=new THREE.FullScreenQuad(this.materialBokeh),this._oldClearColor=new THREE.Color}render(e,r,a){this.scene.overrideMaterial=this.materialDepth,e.getClearColor(this._oldClearColor);const t=e.getClearAlpha(),s=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms["tColor"].value=a.texture,this.uniforms["nearClip"].value=this.camera.near,this.uniforms["farClip"].value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this._oldClearColor),e.setClearAlpha(t),e.autoClear=s}}THREE.BokehPass=e})();