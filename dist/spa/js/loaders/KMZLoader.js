(function(){class e extends THREE.Loader{constructor(e){super(e)}load(e,r,t,o){const n=this,a=new THREE.FileLoader(n.manager);a.setPath(n.path),a.setResponseType("arraybuffer"),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,(function(t){try{r(n.parse(t))}catch(a){o?o(a):console.error(a),n.manager.itemError(e)}}),t,o)}parse(e){function r(e){for(const r in o)if(r.substr(-e.length)===e)return o[r]}const t=new THREE.LoadingManager;t.setURLModifier((function(e){const t=r(e);if(t){console.log("Loading",e);const r=new Blob([t.buffer],{type:"application/octet-stream"});return URL.createObjectURL(r)}return e}));const o=fflate.unzipSync(new Uint8Array(e));if(o["doc.kml"]){const e=(new DOMParser).parseFromString(fflate.strFromU8(o["doc.kml"]),"application/xml"),r=e.querySelector("Placemark Model Link href");if(r){const e=new THREE.ColladaLoader(t);return e.parse(fflate.strFromU8(o[r.textContent]))}}else{console.warn("KMZLoader: Missing doc.kml file.");for(const e in o){const r=e.split(".").pop().toLowerCase();if("dae"===r){const r=new THREE.ColladaLoader(t);return r.parse(fflate.strFromU8(o[e]))}}}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new THREE.Group}}}THREE.KMZLoader=e})();