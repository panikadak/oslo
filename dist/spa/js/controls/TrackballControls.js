(function(){const e={type:"change"},t={type:"start"},o={type:"end"};class n extends THREE.EventDispatcher{constructor(n,c){super(),void 0===c&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),c===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const i=this,a={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=n,this.domElement=c,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.target=new THREE.Vector3;const s=1e-6,r=new THREE.Vector3;let p=1,d=a.NONE,E=a.NONE,m=0,l=0,h=0;const u=new THREE.Vector3,g=new THREE.Vector2,y=new THREE.Vector2,b=new THREE.Vector3,T=new THREE.Vector2,w=new THREE.Vector2,O=new THREE.Vector2,v=new THREE.Vector2,f=[],j={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const e=i.domElement.getBoundingClientRect(),t=i.domElement.ownerDocument.documentElement;i.screen.left=e.left+window.pageXOffset-t.clientLeft,i.screen.top=e.top+window.pageYOffset-t.clientTop,i.screen.width=e.width,i.screen.height=e.height};const R=function(){const e=new THREE.Vector2;return function(t,o){return e.set((t-i.screen.left)/i.screen.width,(o-i.screen.top)/i.screen.height),e}}(),H=function(){const e=new THREE.Vector2;return function(t,o){return e.set((t-.5*i.screen.width-i.screen.left)/(.5*i.screen.width),(i.screen.height+2*(i.screen.top-o))/i.screen.width),e}}();function N(e){!1!==i.enabled&&(0===f.length&&(i.domElement.setPointerCapture(e.pointerId),i.domElement.addEventListener("pointermove",k),i.domElement.addEventListener("pointerup",L)),Z(e),"touch"===e.pointerType?z(e):M(e))}function k(e){!1!==i.enabled&&("touch"===e.pointerType?x(e):P(e))}function L(e){!1!==i.enabled&&("touch"===e.pointerType?S(e):D(),I(e),0===f.length&&(i.domElement.releasePointerCapture(e.pointerId),i.domElement.removeEventListener("pointermove",k),i.domElement.removeEventListener("pointerup",L)))}function A(e){I(e)}function C(e){!1!==i.enabled&&(window.removeEventListener("keydown",C),E===a.NONE&&(e.code!==i.keys[a.ROTATE]||i.noRotate?e.code!==i.keys[a.ZOOM]||i.noZoom?e.code!==i.keys[a.PAN]||i.noPan||(E=a.PAN):E=a.ZOOM:E=a.ROTATE))}function V(){!1!==i.enabled&&(E=a.NONE,window.addEventListener("keydown",C))}function M(e){if(d===a.NONE)switch(e.button){case i.mouseButtons.LEFT:d=a.ROTATE;break;case i.mouseButtons.MIDDLE:d=a.ZOOM;break;case i.mouseButtons.RIGHT:d=a.PAN;break;default:d=a.NONE}const o=E!==a.NONE?E:d;o!==a.ROTATE||i.noRotate?o!==a.ZOOM||i.noZoom?o!==a.PAN||i.noPan||(O.copy(R(e.pageX,e.pageY)),v.copy(O)):(T.copy(R(e.pageX,e.pageY)),w.copy(T)):(y.copy(H(e.pageX,e.pageY)),g.copy(y)),i.dispatchEvent(t)}function P(e){const t=E!==a.NONE?E:d;t!==a.ROTATE||i.noRotate?t!==a.ZOOM||i.noZoom?t!==a.PAN||i.noPan||v.copy(R(e.pageX,e.pageY)):w.copy(R(e.pageX,e.pageY)):(g.copy(y),y.copy(H(e.pageX,e.pageY)))}function D(){d=a.NONE,i.dispatchEvent(o)}function Y(e){if(!1!==i.enabled&&!0!==i.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:T.y-=.025*e.deltaY;break;case 1:T.y-=.01*e.deltaY;break;default:T.y-=25e-5*e.deltaY;break}i.dispatchEvent(t),i.dispatchEvent(o)}}function z(e){switch(U(e),f.length){case 1:d=a.TOUCH_ROTATE,y.copy(H(f[0].pageX,f[0].pageY)),g.copy(y);break;default:d=a.TOUCH_ZOOM_PAN;const e=f[0].pageX-f[1].pageX,t=f[0].pageY-f[1].pageY;l=m=Math.sqrt(e*e+t*t);const o=(f[0].pageX+f[1].pageX)/2,n=(f[0].pageY+f[1].pageY)/2;O.copy(R(o,n)),v.copy(O);break}i.dispatchEvent(t)}function x(e){switch(U(e),f.length){case 1:g.copy(y),y.copy(H(e.pageX,e.pageY));break;default:const t=_(e),o=e.pageX-t.x,n=e.pageY-t.y;l=Math.sqrt(o*o+n*n);const c=(e.pageX+t.x)/2,i=(e.pageY+t.y)/2;v.copy(R(c,i));break}}function S(e){switch(f.length){case 0:d=a.NONE;break;case 1:d=a.TOUCH_ROTATE,y.copy(H(e.pageX,e.pageY)),g.copy(y);break;case 2:d=a.TOUCH_ZOOM_PAN,y.copy(H(e.pageX-g.pageX,e.pageY-g.pageY)),g.copy(y);break}i.dispatchEvent(o)}function X(e){!1!==i.enabled&&e.preventDefault()}function Z(e){f.push(e)}function I(e){delete j[e.pointerId];for(let t=0;t<f.length;t++)if(f[t].pointerId==e.pointerId)return void f.splice(t,1)}function U(e){let t=j[e.pointerId];void 0===t&&(t=new THREE.Vector2,j[e.pointerId]=t),t.set(e.pageX,e.pageY)}function _(e){const t=e.pointerId===f[0].pointerId?f[1]:f[0];return j[t.pointerId]}this.rotateCamera=function(){const e=new THREE.Vector3,t=new THREE.Quaternion,o=new THREE.Vector3,n=new THREE.Vector3,c=new THREE.Vector3,a=new THREE.Vector3;return function(){a.set(y.x-g.x,y.y-g.y,0);let s=a.length();s?(u.copy(i.object.position).sub(i.target),o.copy(u).normalize(),n.copy(i.object.up).normalize(),c.crossVectors(n,o).normalize(),n.setLength(y.y-g.y),c.setLength(y.x-g.x),a.copy(n.add(c)),e.crossVectors(a,u).normalize(),s*=i.rotateSpeed,t.setFromAxisAngle(e,s),u.applyQuaternion(t),i.object.up.applyQuaternion(t),b.copy(e),h=s):!i.staticMoving&&h&&(h*=Math.sqrt(1-i.dynamicDampingFactor),u.copy(i.object.position).sub(i.target),t.setFromAxisAngle(b,h),u.applyQuaternion(t),i.object.up.applyQuaternion(t)),g.copy(y)}}(),this.zoomCamera=function(){let e;d===a.TOUCH_ZOOM_PAN?(e=m/l,m=l,i.object.isPerspectiveCamera?u.multiplyScalar(e):i.object.isOrthographicCamera?(i.object.zoom/=e,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(w.y-T.y)*i.zoomSpeed,1!==e&&e>0&&(i.object.isPerspectiveCamera?u.multiplyScalar(e):i.object.isOrthographicCamera?(i.object.zoom/=e,i.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),i.staticMoving?T.copy(w):T.y+=(w.y-T.y)*this.dynamicDampingFactor)},this.panCamera=function(){const e=new THREE.Vector2,t=new THREE.Vector3,o=new THREE.Vector3;return function(){if(e.copy(v).sub(O),e.lengthSq()){if(i.object.isOrthographicCamera){const t=(i.object.right-i.object.left)/i.object.zoom/i.domElement.clientWidth,o=(i.object.top-i.object.bottom)/i.object.zoom/i.domElement.clientWidth;e.x*=t,e.y*=o}e.multiplyScalar(u.length()*i.panSpeed),o.copy(u).cross(i.object.up).setLength(e.x),o.add(t.copy(i.object.up).setLength(e.y)),i.object.position.add(o),i.target.add(o),i.staticMoving?O.copy(v):O.add(e.subVectors(v,O).multiplyScalar(i.dynamicDampingFactor))}}}(),this.checkDistances=function(){i.noZoom&&i.noPan||(u.lengthSq()>i.maxDistance*i.maxDistance&&(i.object.position.addVectors(i.target,u.setLength(i.maxDistance)),T.copy(w)),u.lengthSq()<i.minDistance*i.minDistance&&(i.object.position.addVectors(i.target,u.setLength(i.minDistance)),T.copy(w)))},this.update=function(){u.subVectors(i.object.position,i.target),i.noRotate||i.rotateCamera(),i.noZoom||i.zoomCamera(),i.noPan||i.panCamera(),i.object.position.addVectors(i.target,u),i.object.isPerspectiveCamera?(i.checkDistances(),i.object.lookAt(i.target),r.distanceToSquared(i.object.position)>s&&(i.dispatchEvent(e),r.copy(i.object.position))):i.object.isOrthographicCamera?(i.object.lookAt(i.target),(r.distanceToSquared(i.object.position)>s||p!==i.object.zoom)&&(i.dispatchEvent(e),r.copy(i.object.position),p=i.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){d=a.NONE,E=a.NONE,i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.up.copy(i.up0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),u.subVectors(i.object.position,i.target),i.object.lookAt(i.target),i.dispatchEvent(e),r.copy(i.object.position),p=i.object.zoom},this.dispose=function(){i.domElement.removeEventListener("contextmenu",X),i.domElement.removeEventListener("pointerdown",N),i.domElement.removeEventListener("pointercancel",A),i.domElement.removeEventListener("wheel",Y),i.domElement.removeEventListener("pointermove",k),i.domElement.removeEventListener("pointerup",L),window.removeEventListener("keydown",C),window.removeEventListener("keyup",V)},this.domElement.addEventListener("contextmenu",X),this.domElement.addEventListener("pointerdown",N),this.domElement.addEventListener("pointercancel",A),this.domElement.addEventListener("wheel",Y,{passive:!1}),window.addEventListener("keydown",C),window.addEventListener("keyup",V),this.handleResize(),this.update()}}THREE.TrackballControls=n})();